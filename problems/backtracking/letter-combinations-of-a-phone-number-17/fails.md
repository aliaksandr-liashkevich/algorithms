Ошибки
- При решении bits не учел повторные циклы для cyclesPerLetter

Рекомендации
- Нужно было делать отладку до конца
